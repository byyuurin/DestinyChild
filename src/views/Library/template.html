<div class="library">
  <div class="overlay" v-if="openFilter">
    <div class="filter-options">
      <div class="filter-header"></div>
      <div class="filter-content">
        <a
          href="#"
          class="button button-close"
          @click.prevent="openFilter = false"
          >Close</a
        >
        <div class="option-group">
          <div class="option-group-title">
            <input
              id="chk-unknown"
              class="option-checkbox"
              type="checkbox"
              v-model="showUnknown"
            />
            <label class="showUnknown" for="chk-unknown"></label>
            <label for="chk-unknown">顯示無資料的角色</label>
          </div>
        </div>
        <div class="option-group">
          <div class="option-group-title">屬性</div>
          <div class="option-group-content">
            <template v-for="type in types">
              <input
                :id="'chk-type-' + type"
                class="option-checkbox"
                type="checkbox"
                v-model="filter.type[type]"
                @input="filterHandler('type.' + type, $event.target)"
              />
              <label :for="'chk-type-' + type" :class="'type-' + type"> </label>
            </template>
          </div>
        </div>
        <div class="option-group">
          <div class="option-group-title">類型</div>
          <div class="option-group-content">
            <template v-for="profession in professions">
              <input
                :id="'chk-profession-' + profession"
                class="option-checkbox"
                type="checkbox"
                v-model="filter.profession[profession]"
                @input="filterHandler('profession.' + profession, $event.target)"
              />
              <label
                :for="'chk-profession-' + profession"
                :class="'profession-' + profession"
              >
              </label>
            </template>
          </div>
        </div>
      </div>
    </div>
  </div>
  <div class="overlay" v-if="character" @click.self="closeInformationHandler">
    <skill-information :it="character">
      <a
        href="#close"
        class="button button-close"
        @click.prevent="closeInformationHandler"
        >x</a
      >
    </skill-information>
  </div>
  <div :class="['library-header', {blur: character || openFilter}]"></div>
  <div :class="['library-controls', {blur: character || openFilter}]">
    <div class="container">
      <div class="group search">
        <label
          :class="['search-name', {focus: openSearch}]"
          @click.self="openSearch = !openSearch"
          @keydown.esc="openSearch = false"
          @keydown.enter="openSearch = false"
        >
          <input
            class="option-text"
            maxlength="10"
            type="text"
            placeholder="再按一次可關閉。"
            v-model="filter.name"
            @input="filterHandler('name', $event.target)"
        /></label>
        <label class="button button-setting" @click="openFilter = true">
          <img
            src="~@/assets/view/Library/btn_home_config.png"
            alt="filter setup"
          />
        </label>
      </div>
    </div>
  </div>
  <div :class="['container', {blur: character || openFilter}]" v-if="groupSize">
    <div
      :class="['group', group]"
      v-for="(characters, group) in characterGroups"
      v-if="characters.length"
    >
      <div class="group-header">
        <collection-info
          :stars="getGroupStars(group)"
          :counts="getCollectionCounts(characters)"
          :total="characters.length"
        ></collection-info>
      </div>
      <div class="group-content">
        <character-portrait
          :it="character"
          :class="{'cursor-pointer': !!character.id}"
          v-for="character in characters"
          :key="character.icon"
          @click.native="informationHandler(character.icon)"
          @contextmenu.prevent.native="editHandler(character.icon)"
        >
          <div class="ch">{{ character.name_CH }}</div>
          <div class="jp">({{ character.name_JP }})</div>
        </character-portrait>
      </div>
    </div>
  </div>
</div>
