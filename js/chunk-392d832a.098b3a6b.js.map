{"version":3,"sources":["webpack:///./src/views/Narrative/template.html","webpack:///src/views/Narrative/index.vue","webpack:///./src/views/Narrative/index.vue?de9b","webpack:///./src/views/Narrative/index.vue","webpack:///./node_modules/core-js/modules/es6.regexp.flags.js","webpack:///./node_modules/core-js/modules/es6.regexp.to-string.js","webpack:///./src/views/Narrative/style.scss?dabe"],"names":["render","_vm","this","_h","$createElement","_c","_self","staticClass","attrs","setting","link","_v","_s","title","class","isEventEnd","on","$event","changeShowIndex","banner","eventStart","eventEnd","directives","name","rawName","value","expression","$$selectedVal","Array","prototype","filter","call","target","options","o","selected","map","val","_value","boost","multiple","_l","boostRate","domProps","expectedReward","freeReset","eventDays","_f","day","index","highlight","isToday","minReward","staticRenderFns","data","settings","showIndex","computed","settingData","replace","Math","ceil","dayList","push","toLocaleDateString","remainingDays","today","methods","reward","battleRound","battleCounts","boxReward","normal","bx","rewardOdds","boxRewardOdds","boxCount","boss","sumBoxReward","totalReward","battleReward","floor","x","round","avgReward","setHours","setMinutes","setSeconds","setMilliseconds","afterIndex","settingLength","filters","numberWithComma","regex","test","s","created","fetch","watch","component","flags","f","RegExp","configurable","get","anObject","$flags","DESCRIPTORS","TO_STRING","$toString","define","fn","source","R","concat","undefined"],"mappings":"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","file":"js/chunk-392d832a.098b3a6b.js","sourcesContent":["var render = function () {var _vm=this;var _h=_vm.$createElement;var _c=_vm._self._c||_h;return _c('div',{staticClass:\"narrative\"},[_c('div',{staticClass:\"container\"},[_c('h2',{staticClass:\"page-title\"},[_c('a',{attrs:{\"href\":_vm.setting.link,\"target\":\"_blank\"}},[_vm._v(_vm._s(_vm.setting.title))])]),_c('div',{staticClass:\"event-info\",class:{'event-end':_vm.isEventEnd}},[_c('div',{staticClass:\"profile\"},[_c('div',{staticClass:\"banner\"},[_c('a',{staticClass:\"btn btn-prev\",on:{\"click\":function($event){_vm.changeShowIndex(-1)}}}),_c('a',{staticClass:\"btn btn-next\",on:{\"click\":function($event){_vm.changeShowIndex(1)}}}),_c('img',{attrs:{\"src\":_vm.setting.banner}})]),_c('div',{staticClass:\"event-period\"},[_c('strong',[_vm._v(\"活動期間\")]),_vm._v(\" \"+_vm._s(_vm.setting.eventStart)+\" -\\n          \"+_vm._s(_vm.setting.eventEnd)+\"\\n        \")]),_c('div',{staticClass:\"boost-options\"},[_c('strong',[_vm._v(\"Boost\")]),_c('select',{directives:[{name:\"model\",rawName:\"v-model\",value:(_vm.boost),expression:\"boost\"}],on:{\"change\":function($event){var $$selectedVal = Array.prototype.filter.call($event.target.options,function(o){return o.selected}).map(function(o){var val = \"_value\" in o ? o._value : o.value;return val}); _vm.boost=$event.target.multiple ? $$selectedVal : $$selectedVal[0]}}},_vm._l((_vm.setting.boost),function(boostRate){return _c('option',{domProps:{\"value\":boostRate}},[_vm._v(\"\\n              +\"+_vm._s(boostRate - 100)+\"%\\n            \")])}),0)]),_c('div',{staticClass:\"expected-info\"},[_c('div',{staticClass:\"expected-round\"},[_c('strong',[_vm._v(\"期望值(1回)\")]),_vm._v(\" \"+_vm._s(_vm.expectedReward(1))+\"\\n          \")]),_c('div',{staticClass:\"expected-day\"},[_c('strong',[_vm._v(\"期望值(1日)\")]),_vm._v(\" \"+_vm._s(_vm.expectedReward(_vm.setting.freeReset))+\"\\n          \")]),_c('div',{staticClass:\"expected-all\"},[_c('strong',[_vm._v(\"期望值(\"+_vm._s(_vm.eventDays)+\"日)\")]),_vm._v(\"\\n            \"+_vm._s(this.expectedReward(_vm.setting.freeReset * _vm.eventDays))+\"\\n          \")])])]),_c('div',{staticClass:\"schedule\"},[_c('table',[_c('thead',[_c('tr',[_c('th',[_vm._v(\"目標值\")]),_vm._l((_vm.setting.rewardTarget),function(target){return _c('th',[_vm._v(\"\\n                \"+_vm._s(_vm._f(\"numberWithComma\")(target))+\"\\n              \")])})],2)]),_c('tbody',_vm._l((_vm.dayList),function(day,index){return _c('tr',{class:{highlight: _vm.isToday(day)}},[_c('td',[_vm._v(_vm._s(day))]),_vm._l((_vm.setting.rewardTarget),function(target){return _c('td',[_vm._v(\"\\n                \"+_vm._s(_vm._f(\"numberWithComma\")(_vm.minReward(index + 1, target)))+\"\\n              \")])})],2)}),0)])])])])])}\nvar staticRenderFns = []\n\nexport { render, staticRenderFns }","<style lang=\"scss\" src=\"./style.scss\" scoped></style>\n<template src=\"./template.html\"></template>\n<script>\nexport default {\n  name: 'narrative',\n  data() {\n    return {\n      boost: 100,\n      settings: [],\n      showIndex: 0\n    }\n  },\n  computed: {\n    setting() {\n      const settingData = this.settings[this.showIndex] || {}\n      if (settingData.banner) {\n        settingData.banner = settingData.banner.replace('http://', 'https://')\n      }\n      return settingData\n    },\n    eventDays() {\n      if (!this.setting) return 0\n\n      const eventStart = new Date(this.setting.eventStart)\n      const eventEnd = new Date(this.setting.eventEnd)\n\n      return Math.ceil((eventEnd - eventStart) / 1000 / 60 / 60 / 24)\n    },\n    dayList() {\n      let dayList = []\n      if (this.setting) {\n        const eventStart = new Date(this.setting.eventStart)\n\n        for (let i = 0; i < this.eventDays; i++) {\n          let day = new Date(eventStart.getTime() + i * 1000 * 60 * 60 * 24)\n          dayList.push(day.toLocaleDateString())\n        }\n      }\n      return dayList\n    },\n    remainingDays() {\n      if (!this.setting) return 0\n\n      const eventEnd = new Date(this.setting.eventEnd)\n      const today = new Date()\n\n      return Math.ceil((eventEnd - today) / 1000 / 60 / 60 / 24)\n    },\n    isEventEnd() {\n      return this.remainingDays < 0\n    }\n  },\n  methods: {\n    expectedReward(x = 1) {\n      if (!this.setting.reward) return 0\n\n      const battleCounts = this.setting.reward.length\n      let totalReward = 0\n\n      for (let i = 0; i < battleCounts; i++) {\n        let battleRound = i + 1\n        let battleReward = this.setting.reward[i]\n        let boxCount = this.setting.maxFreeBox\n\n        if (battleRound === battleCounts) {\n          const boxReward = { normal: 0, boss: 0 }\n          let rewardCount = this.setting.boxReward.normal.length\n          let sumBoxReward = 0\n\n          for (let bx = 0; bx < rewardCount; bx++) {\n            let reward, rewardOdds\n\n            // Normal Round reward\n            reward = this.setting.boxReward.normal[bx]\n            rewardOdds = this.setting.boxRewardOdds.normal[bx]\n            boxReward.normal += reward * rewardOdds * boxCount\n\n            // Boss Round reward\n            reward = this.setting.boxReward.boss[bx]\n            rewardOdds = this.setting.boxRewardOdds.boss[bx]\n            boxReward.boss += reward * rewardOdds * boxCount\n          }\n\n          sumBoxReward += boxReward.normal * (battleCounts - 1)\n          sumBoxReward += boxReward.boss\n          totalReward += battleReward + sumBoxReward\n        } else {\n          // Normal Round\n          totalReward += battleReward\n        }\n      }\n\n      return Math.floor(totalReward * x * this.boost) / 100\n    },\n    minReward(day, target) {\n      let avgReward = target / this.eventDays\n      return Math.round(avgReward * day)\n    },\n    isToday(d) {\n      let today = new Date()\n      let day = new Date(d)\n      today.setHours(0)\n      today.setMinutes(0)\n      today.setSeconds(0)\n      today.setMilliseconds(0)\n      return day - today === 0\n    },\n    changeShowIndex(offset) {\n      let afterIndex = this.showIndex + offset\n      let settingLength = this.settings.length\n\n      if (afterIndex >= settingLength) {\n        afterIndex = settingLength - 1\n      }\n\n      if (afterIndex < 0) {\n        afterIndex = 0\n      }\n\n      // 只有 showIndex 變動時才將 boost 重置回預設值\n      if (this.showIndex !== afterIndex) {\n        this.boost = 100\n      }\n\n      this.showIndex = afterIndex\n    }\n  },\n  filters: {\n    numberWithComma(n) {\n      let regex = /(-?\\d+)(\\d{3})/\n      let s = n.toString()\n      while (regex.test(s)) {\n        s = s.replace(regex, '$1,$2')\n      }\n      return s\n    }\n  },\n  created() {\n    fetch('./api/narrative.json')\n      .then(res => {\n        return res.json()\n      })\n      .then(data => {\n        this.settings = data\n        this.showIndex = data.length - 1\n      })\n  },\n  watch: {\n    showIndex() {\n      this.boost = 100\n    }\n  }\n}\n</script>\n","import mod from \"-!../../../node_modules/cache-loader/dist/cjs.js??ref--12-0!../../../node_modules/thread-loader/dist/cjs.js!../../../node_modules/babel-loader/lib/index.js!../../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./index.vue?vue&type=script&lang=js&\"; export default mod; export * from \"-!../../../node_modules/cache-loader/dist/cjs.js??ref--12-0!../../../node_modules/thread-loader/dist/cjs.js!../../../node_modules/babel-loader/lib/index.js!../../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./index.vue?vue&type=script&lang=js&\"","import { render, staticRenderFns } from \"./template.html?vue&type=template&id=6026cc5f&scoped=true&\"\nimport script from \"./index.vue?vue&type=script&lang=js&\"\nexport * from \"./index.vue?vue&type=script&lang=js&\"\nimport style0 from \"./style.scss?vue&type=style&index=0&id=6026cc5f&lang=scss&scoped=true&\"\n\n\n/* normalize component */\nimport normalizer from \"!../../../node_modules/vue-loader/lib/runtime/componentNormalizer.js\"\nvar component = normalizer(\n  script,\n  render,\n  staticRenderFns,\n  false,\n  null,\n  \"6026cc5f\",\n  null\n  \n)\n\nexport default component.exports","// 21.2.5.3 get RegExp.prototype.flags()\nif (require('./_descriptors') && /./g.flags != 'g') require('./_object-dp').f(RegExp.prototype, 'flags', {\n  configurable: true,\n  get: require('./_flags')\n});\n","'use strict';\nrequire('./es6.regexp.flags');\nvar anObject = require('./_an-object');\nvar $flags = require('./_flags');\nvar DESCRIPTORS = require('./_descriptors');\nvar TO_STRING = 'toString';\nvar $toString = /./[TO_STRING];\n\nvar define = function (fn) {\n  require('./_redefine')(RegExp.prototype, TO_STRING, fn, true);\n};\n\n// 21.2.5.14 RegExp.prototype.toString()\nif (require('./_fails')(function () { return $toString.call({ source: 'a', flags: 'b' }) != '/a/b'; })) {\n  define(function toString() {\n    var R = anObject(this);\n    return '/'.concat(R.source, '/',\n      'flags' in R ? R.flags : !DESCRIPTORS && R instanceof RegExp ? $flags.call(R) : undefined);\n  });\n// FF44- RegExp#toString has a wrong name\n} else if ($toString.name != TO_STRING) {\n  define(function toString() {\n    return $toString.call(this);\n  });\n}\n","import mod from \"-!../../../node_modules/mini-css-extract-plugin/dist/loader.js??ref--8-oneOf-1-0!../../../node_modules/css-loader/index.js??ref--8-oneOf-1-1!../../../node_modules/vue-loader/lib/loaders/stylePostLoader.js!../../../node_modules/postcss-loader/src/index.js??ref--8-oneOf-1-2!../../../node_modules/sass-loader/lib/loader.js??ref--8-oneOf-1-3!./style.scss?vue&type=style&index=0&id=6026cc5f&lang=scss&scoped=true&\"; export default mod; export * from \"-!../../../node_modules/mini-css-extract-plugin/dist/loader.js??ref--8-oneOf-1-0!../../../node_modules/css-loader/index.js??ref--8-oneOf-1-1!../../../node_modules/vue-loader/lib/loaders/stylePostLoader.js!../../../node_modules/postcss-loader/src/index.js??ref--8-oneOf-1-2!../../../node_modules/sass-loader/lib/loader.js??ref--8-oneOf-1-3!./style.scss?vue&type=style&index=0&id=6026cc5f&lang=scss&scoped=true&\""],"sourceRoot":""}